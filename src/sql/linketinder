CREATE TABLE candidatos (
  id serial PRIMARY KEY,
  nome varchar NOT NULL,
  sobrenome varchar NOT NULL,
  dataNascimento date NOT NULL,
  email varchar NOT NULL,
  cpf varchar NOT NULL,
  pais varchar NOT NULL,
  cep varchar NOT NULL,
  descricao varchar NOT NULL,
  senha varchar NOT NULL
);

CREATE TABLE empresas (
  id serial PRIMARY KEY,
  nome varchar NOT NULL,
  cnpj varchar NOT NULL,
  email varchar NOT NULL,
  descricao varchar NOT NULL,
  pais varchar NOT NULL,
  cep varchar NOT NULL,
  senha varchar NOT NULL
);

CREATE TABLE competencias (
  id serial PRIMARY KEY,
  nome varchar NOT NULL,
  nivel varchar NOT NULL
);

CREATE TABLE vagas (
  id serial PRIMARY KEY,
  idEmpresa int NOT NULL,
  nome varchar NOT NULL,
  descricao varchar NOT NULL,
  cidade varchar NOT NULL,
  formacaoMinima varchar NOT NULL,
  experienciaMinina varchar NOT NULL
);

CREATE TABLE candidato_competencia (
  id serial PRIMARY KEY,
  idCandidato int NOT NULL,
  idCompetencia int NOT NULL
);

CREATE TABLE vaga_competencia (
  id serial PRIMARY KEY,
  idVaga int NOT NULL,
  idCompetencia int NOT NULL
);

CREATE TABLE formacoes (
  id serial PRIMARY KEY,
  idCandidato int NOT NULL,
  instituicao varchar NOT NULL,
  curso varchar NOT NULL,
  nivel varchar NOT NULL,
  AnoConclusao varchar NOT NULL
);

CREATE TABLE experiencias (
  id serial PRIMARY KEY,
  idCandidato int NOT NULL,
  cargo varchar NOT NULL,
  empresa varchar NOT NULL,
  nivel varchar NOT NULL
);

CREATE TABLE vagas_curtidas (
  id serial PRIMARY KEY,
  idCandidato int NOT NULL,
  idVaga int NOT NULL
);

CREATE TABLE candidatos_curtidos (
  id serial PRIMARY KEY,
  idCandidato int NOT NULL,
  idEmpresa int NOT NULL
);

ALTER TABLE vagas ADD FOREIGN KEY (idEmpresa) REFERENCES empresas (id);

ALTER TABLE candidato_competencia ADD FOREIGN KEY (idCandidato) REFERENCES candidatos (id);

ALTER TABLE candidato_competencia ADD FOREIGN KEY (idCompetencia) REFERENCES competencias (id);

ALTER TABLE vaga_competencia ADD FOREIGN KEY (idVaga) REFERENCES vagas (id);

ALTER TABLE vaga_competencia ADD FOREIGN KEY (idCompetencia) REFERENCES competencias (id);

ALTER TABLE formacoes ADD FOREIGN KEY (idCandidato) REFERENCES candidatos (id);

ALTER TABLE experiencias ADD FOREIGN KEY (idCandidato) REFERENCES candidatos (id);

ALTER TABLE vagas_curtidas ADD FOREIGN KEY (idCandidato) REFERENCES candidatos (id);

ALTER TABLE vagas_curtidas ADD FOREIGN KEY (idVaga) REFERENCES vagas (id);

ALTER TABLE candidatos_curtidos ADD FOREIGN KEY (idCandidato) REFERENCES candidatos (id);

ALTER TABLE candidatos_curtidos ADD FOREIGN KEY (idEmpresa) REFERENCES empresas (id);


-- Inserir Candidatos
INSERT INTO Candidatos (nome, sobrenome, dataNascimento, email, cpf, pais, cep, descricao, senha)
VALUES
  ('Candidato 1', 'Sobrenome 1', '1990-01-01', 'candidato1@email.com', '123.456.789-00', 'Brasil', '12345-678', 'Descrição do Candidato 1', 'senha123'),
  ('Candidato 2', 'Sobrenome 2', '1985-05-10', 'candidato2@email.com', '987.654.321-00', 'Brasil', '98765-432', 'Descrição do Candidato 2', 'senha456'),
  ('Candidato 3', 'Sobrenome 3', '1998-08-20', 'candidato3@email.com', '555.555.555-00', 'Brasil', '55555-555', 'Descrição do Candidato 3', 'senha789'),
  ('Candidato 4', 'Sobrenome 4', '1992-03-15', 'candidato4@email.com', '111.111.111-00', 'Brasil', '11111-111', 'Descrição do Candidato 4', 'senhaabc'),
  ('Candidato 5', 'Sobrenome 5', '1987-11-30', 'candidato5@email.com', '999.999.999-00', 'Brasil', '99999-999', 'Descrição do Candidato 5', 'senhaxyz');

INSERT INTO Empresas (nome, cnpj, email, descricao, pais, cep, senha)
VALUES
  ('Empresa A', '123456789', 'empresa.a@example.com', 'Descrição da Empresa A', 'Brasil', '12345-678', 'senha123'),
  ('Empresa B', '987654321', 'empresa.b@example.com', 'Descrição da Empresa B', 'Brasil', '98765-432', 'senha456'),
  ('Empresa C', '555555555', 'empresa.c@example.com', 'Descrição da Empresa C', 'Brasil', '55555-555', 'senha789'),
  ('Empresa D', '111111111', 'empresa.d@example.com', 'Descrição da Empresa D', 'Brasil', '11111-111', 'senhaabc'),
  ('Empresa E', '999999999', 'empresa.e@example.com', 'Descrição da Empresa E', 'Brasil', '99999-999', 'senhaxyz');
  
  -- Inserção de vagas
INSERT INTO vagas (idEmpresa, nome, descricao, cidade, formacaoMinima, experienciaMinina)
VALUES
(1, 'Desenvolvedor Java', 'Desenvolvimento de aplicativos Java', 'São Paulo', 'Graduação em Ciência da Computação', '1 ano de experiência em Java'),
(2, 'Designer Gráfico', 'Criação de materiais visuais', 'Rio de Janeiro', 'Graduação em Design Gráfico', 'Experiência em Adobe Creative Suite'),
(3, 'Analista de Dados', 'Análise de dados para tomada de decisões', 'Belo Horizonte', 'Graduação em Estatística ou áreas relacionadas', 'Experiência em análise de dados'),
(4, 'Engenheiro de Software', 'Desenvolvimento de software para sistemas complexos', 'Porto Alegre', 'Graduação em Engenharia de Software ou áreas afins', '2 anos de experiência em desenvolvimento'),
(5, 'Gerente de Projetos', 'Gestão de projetos de grande porte', 'Curitiba', 'Graduação em Administração ou Gerenciamento de Projetos', 'Experiência em liderança de equipes');


--Candidato curte vaga
-- Candidato com ID 1 curte a vaga com ID 1
INSERT INTO vagas_curtidas (idCandidato, idVaga) VALUES (1, 2);

-- Candidato com ID 2 curte a vaga com ID 1
INSERT INTO vagas_curtidas (idCandidato, idVaga) VALUES (2, 2);

-- Candidato com ID 3 curte a vaga com ID 2
INSERT INTO vagas_curtidas (idCandidato, idVaga) VALUES (3, 2);

-- Candidato com ID 1 curte a vaga com ID 3
INSERT INTO vagas_curtidas (idCandidato, idVaga) VALUES (1, 3);

--Empresa Curte candidato
-- Empresa com ID 1 curte o candidato com ID 1
INSERT INTO candidatos_curtidos (idCandidato, idEmpresa) VALUES (1, 1);

-- Empresa com ID 2 curte o candidato com ID 1
INSERT INTO candidatos_curtidos (idCandidato, idEmpresa) VALUES (1, 2);

-- Empresa com ID 3 curte o candidato com ID 2
INSERT INTO candidatos_curtidos (idCandidato, idEmpresa) VALUES (2, 3);

-- Empresa com ID 1 curte o candidato com ID 3
INSERT INTO candidatos_curtidos (idCandidato, idEmpresa) VALUES (3, 1);

--Identificar Matchs entre Candidatos e Vagas
SELECT vc.idCandidato, vc.idVaga
FROM vagas_curtidas vc
JOIN candidatos_curtidos cc ON vc.idCandidato = cc.idCandidato AND vc.idVaga = cc.idEmpresa

--Identificar Matchs entre Empresas e Candidatos
SELECT cc.idCandidato, cc.idEmpresa
FROM candidatos_curtidos cc
JOIN vagas_curtidas vc ON cc.idCandidato = vc.idCandidato AND cc.idEmpresa = vc.idVaga


